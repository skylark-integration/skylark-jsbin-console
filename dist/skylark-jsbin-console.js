/**
 * skylark-jsbin-console - A version of jsbin-console  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-console/
 * @license MIT
 */
!function(factory,globals){var define=globals.define,require=globals.require,isAmd="function"==typeof define&&define.amd,isCmd=!isAmd&&"undefined"!=typeof exports;if(!isAmd&&!define){var map={};define=globals.define=function(e,o,t){"function"==typeof t?(map[e]={factory:t,deps:o.map(function(o){return function(e,o){if("."!==e[0])return e;var t=o.split("/"),n=e.split("/");t.pop();for(var r=0;r<n.length;r++)"."!=n[r]&&(".."==n[r]?t.pop():t.push(n[r]));return t.join("/")}(o,e)}),resolved:!1,exports:null},require(e)):map[e]={factory:null,resolved:!0,exports:t}},require=globals.require=function(e){if(!map.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=map[e];if(!module.resolved){var o=[];module.deps.forEach(function(e){o.push(require(e))}),module.exports=module.factory.apply(globals,o)||null,module.resolved=!0}return module.exports}}if(!define)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(define,require){define("skylark-jsbin-console/jsbin",["skylark-langx/skylark"],function(e){return e.attach("intg.jsbin")}),define("skylark-jsbin-console/console",["skylark-jquery","./jsbin"],function($,jsbin){"use strict";var $document=$(document),keylib={left:37,up:38,right:39,down:40,space:32,alt:18,ctrl:17,shift:16,tab:9,enter:13,webkitEnter:10,escape:27,backspace:8,zero:48,one:49,two:50,three:51,four:52,five:53,six:57,seven:58,eight:59,nine:60,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90};function cleanse(e){return(e||"").replace(/[<&]/g,function(e){return{"&":"&amp;","<":"&lt;"}[e]})}var historyPosition=-1,run=function(e,o){var t=internalCommand(e);if(t)return o(["info",t]);$document.trigger("console:run",e)},post=function(e,o,t){var n="";if("string"!=typeof e?(n=e.echo,o=e.blind,t=e.response,e=e.cmd):n=e,e=trim(e),o||(history.push(e.trim()),setHistory(history)),echo(n.trim()),t)return showResponse(t);run(e,showResponse),setCursorTo("")},showResponse=function(e){var o=document.createElement("div"),t=document.createElement("li"),n=document.createElement("span");output.parentNode;historyPosition=history.length,void 0!==e&&(o.className="response",n.innerHTML=e[1],o.appendChild(n),t.className=e[0],t.innerHTML='<span class="gutter"></span>',t.appendChild(o),appendLog(t),exec.value="")};function log(e,o){var t=document.createElement("li"),n=document.createElement("div");n.innerHTML=e,t.className=o||"log",t.innerHTML='<span class="gutter"></span>',t.appendChild(n),appendLog(t)}function echo(e){var o=document.createElement("li");o.className="echo",o.innerHTML='<span class="gutter"></span><div>'+cleanse(e)+"</div>",logAfter=null,appendLog(o,!0)}function appendLog(e,o){output.appendChild(e),output.parentNode.scrollTop=output.parentNode.scrollHeight+1e3}function internalCommand(e){var o,t=[];if(":"==e.substr(0,1))return t=e.substr(1).split(" "),o=t.shift(),(commands[o]||noop).apply(this,t)}function noop(){}function showhelp(){return[":reset - destroy state and start afresh",":history - list current session history",":load &lt;url&gt; - to inject new DOM",":load &lt;script_url&gt; - to inject external library","      load also supports following shortcuts: <br />      jquery, underscore, prototype, mootools, dojo, rightjs, coffeescript, yui.<br />      eg. :load jquery",":clear - to clear contents of the console",":about jsconsole"].join("\n")}window.info=function(e){var o=document.createElement("li");o.className="info",o.innerHTML='<span class="gutter"></span><div>'+cleanse(e)+"</div>",appendLog(o)};var load=($document.on("console:load:script:error",function(e,o){showResponse(["error",o])}),$document.on("console:load:script:success",function(e,o){showResponse(["response",'Loaded "'+o+'"'])}),$document.on("console:load:dom:error",function(e,o){showResponse(["error",o])}),$document.on("console:load:dom:success",function(e,o){showResponse(["response","Loaded DOM."])}),function(e){return navigator.onLine?arguments.length>1||libraries[e]||-1!==e.indexOf(".js")?loadScript.apply(this,arguments):loadDOM(e):"You need to be online to use :load"});function loadScript(){for(var e=0;e<arguments.length;e++)o=libraries[arguments[e]]||arguments[e],$document.trigger("console:load:script",o);var o;return"Loading script..."}function loadDOM(e){var o=document.createElement("script"),t="loadDOM"+ +new Date;return o.src="http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22"+encodeURIComponent(e)+"%22&format=xml&callback="+t,window[t]=function(e){if(e.results.length){var o=e.results[0].replace(/type="text\/javascript"/gi,'type="x"').replace(/<body.*?>/,"").replace(/<\/body>/,"");$document.trigger("console:load:dom",o)}else log("Failed to load DOM","error");try{window[t]=null,delete window[t]}catch(e){}},document.body.appendChild(o),"Loading URL into DOM..."}function trim(e){return(e||"").replace(/^\s+|\s+$/g,"")}var ccCache={},ccPosition=!1;function about(){return'Ported to JS Bin from <a target="_new" href="http://jsconsole.com">jsconsole.com</a>'}function setHistory(e){if(historyPosition=e.length,"undefined"!=typeof JSON)try{sessionStorage.setItem("history",JSON.stringify(e))}catch(e){}}function getHistory(){var e=[""];if("undefined"==typeof JSON)return e;try{e=JSON.parse(sessionStorage.getItem("history")||'[""]')}catch(e){}return e}function showHistory(){var e=getHistory();return e.shift(),e.join("\n")}window._console={clear:function(){output.innerHTML=""},assert:function(){if(0===arguments.length||!eval(arguments[0])){var msg=[];for(var p in arguments)"0"!==p&&msg.push(arguments[p]);var assertionMsg=msg.join(" ")||"console.assert";log("Assertion failed: "+assertionMsg,"error")}},log:function(){for(var e=arguments.length,o=0;o<e;o++)log(""+arguments[o],!0)},dir:function(){for(var e=arguments.length,o=0;o<e;o++)log(arguments[o])},props:function(e){var o=[];try{for(var t in e)o.push(t)}catch(e){}return o},error:function(e){log(e.message||e,"error")}},window._console.info=window._console.log;var exec=document.getElementById("exec"),form=exec.form||{},output=null,history=getHistory(),fakeConsole="window.parent._console",libraries={jquery:"http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js",prototype:"http://ajax.googleapis.com/ajax/libs/prototype/1/prototype.js",dojo:"http://ajax.googleapis.com/ajax/libs/dojo/1/dojo/dojo.xd.js",mootools:"http://ajax.googleapis.com/ajax/libs/mootools/1/mootools-yui-compressed.js",underscore:"http://jashkenas.github.io/underscore/underscore-min.js",rightjs:"http://rightjs.org/hotlink/right.js",coffeescript:"http://jashkenas.github.io/coffee-script/extras/coffee-script.js",yui:"http://yui.yahooapis.com/3.9.1/build/yui/yui-min.js"},body=document.getElementsByTagName("body")[0],logAfter=null,lastCmd=null,wait=!1,commandPresent=/:((?:help|about|load|clear|reset|wait|history)(?:.*))\n/gi,commands={history:showHistory,help:showhelp,about:about,load:load,wait:function(){return wait=!0,""},clear:function(){return setTimeout(function(){output.innerHTML=""},10),"clearing..."},reset:function(){return output.innerHTML="",jsconsole.init(output,!0),"Context reset"}},fakeInput=null,getCursor=function(){return document.getElementById("cursor")||{focus:function(){}}},iOSMobile=-1!==navigator.userAgent.indexOf("AppleWebKit")&&-1!==navigator.userAgent.indexOf("Mobile"),enableCC=-1!==navigator.userAgent.indexOf("AppleWebKit")&&-1===navigator.userAgent.indexOf("Mobile")||-1!==navigator.userAgent.indexOf("OS 5_");function whichKey(e){return{38:1,40:1,Up:38,Down:40,Enter:10,"U+0009":9,"U+0008":8,"U+0190":190,Right:39,"U+0028":57,"U+0026":55}[e.keyIdentifier]||e.which||e.keyCode}function setCursorTo(e,o){var t=exec.value;exec.value=o?t+e:e;var n=e.match(/\n/g);exec.setAttribute("rows",null!==n?n.length+1:1)}function findNode(e,o){for(var t=0,n=0;n<e.length;n++){if(e[n]==o)return t;e[n].nodeValue.length}return-1}$("#console").addClass("plain"),exec.onkeydown=function(e){e=e||window.event;body.className;var o=whichKey(e),t=o==keylib.enter||o==keylib.webkitEnter;if("string"==typeof o&&(o=o.replace(/\/U\+/,"\\u")),{38:1,40:1}[o]){if(e.shiftKey)return;if(o==keylib.up&&--historyPosition<0&&(historyPosition=0),o==keylib.down&&++historyPosition>=history.length&&(historyPosition=history.length),void 0!=history[historyPosition]&&""!==history[historyPosition])return setCursorTo(history[historyPosition]),!1;if(historyPosition==history.length)return setCursorTo(""),!1}else{if(t&&0==e.shiftKey){var n=exec.textContent||exec.value;return n.length&&post(n),!1}if(t&&1==e.shiftKey){var r=exec.value.match(/\n/g);r=null!=r?r.length+2:2,exec.setAttribute("rows",r)}else(e.shiftKey&&e.metaKey&&o==keylib.backspace||e.ctrlKey&&o==keylib.l)&&(output.innerHTML="")}},form.onsubmit=function(e){return(e=e||window.event).preventDefault&&e.preventDefault(),post(exec.textContent||exec.value),!1},document.onkeydown=function(e){var o=(e=e||window.event).which||e.keyCode;e.shiftKey&&e.metaKey&&8==o?(output.innerHTML="",getCursor().focus()):e.target==output.parentNode&&32==o&&(output.parentNode.scrollTop+=5+output.parentNode.offsetHeight*(e.shiftKey?-1:1))},exec.onclick=function(){getCursor().focus()};var jsconsole={run:post,clear:commands.clear,reset:function(){this.run(":reset")},focus:function(){$(exec).focus()},echo:echo,_onloadQueue:[],onload:function(e){var o=0,t=this._onloadQueue.length;if(!1===this.ready&&e)this._onloadQueue.push(e);else if(!0!==this.ready||e)e&&e.call(this);else{for(;o<t;o++)this._onloadQueue[o].call(this);this._onloadQueue=[]}},init:function(e,o){output=e,jsconsole.ready=!0,jsconsole.onload(),void 0===o&&post(":help",!0)},rawMessage:function(e){e.type&&"error"==e.type?post(e.cmd,!0,["error",e.response]):e.type&&"info"==e.type?window.top.info(e.response):(-1===e.cmd.indexOf("console.log")&&(e.response=e.response.substr(1,e.response.length-2)),echo(e.cmd),log(e.response,"response"))},setCursorTo:setCursorTo};return jsbin.console=jsconsole}),define("skylark-jsbin-console/main",["./console"],function(e){return e}),define("skylark-jsbin-console",["skylark-jsbin-console/main"],function(e){return e})}(define,require),!isAmd){var skylarkjs=require("skylark-langx-ns");isCmd?module.exports=skylarkjs:globals.skylarkjs=skylarkjs}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-jsbin-console.js.map
